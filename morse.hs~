decWith :: String -> String -> Either a Char
decWith [] (x:_)  = Right x
decWith (l:ls) (_:xs) | l=='.' = decWith ls fstHalf
                  | l=='-' = decWith ls sndHalf
                  | otherwise = Left . error $ "Trovati simboli diversi da \".\" o \"-\"!"
                  where
                      half = length xs `div` 2
                      fstHalf = take half xs
                      sndHalf = drop half xs
decWith _ _ = Left . error "La lettera Ã¨ troppo lunga!"

dec :: String -> Either a Char
dec x = decWith x "_eisuarwtndkmgo"